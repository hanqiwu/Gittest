use strict;              # Global variables must be qualified lik
                         # $Package::variable, others must be defined with my.
use English;             # Get aliases for the built-in punctuation variables.
use Carp;                # Get detailed trace back


######################################################################################

my $dirName =  $ENV{TKTKOA_GENERATOR_BASE_DIR} . "pcosgn/sgn/subsystem/";

my $sgsmeta = $dirName . "sgnrap/sgsmeta_mx.cf";
my $cdb_rawviews = $dirName . "sgncdb/sgncdb_cre_rawviews.sql";
#my $cdb_rawviews_gc = $dirName . "sgncdb/sgncdb_cre_rawviews_gc.sql";
my $rdb_psviews = $dirName . "sgnrdb/sgnrdb_cre_psviews.sql";
my $rdb_pvviews = $dirName . "sgnrdb/sgnrdb_cre_pvviews.sql";
my $rdb_tables = $dirName . "sgnrdb/sgnrdb_cre_tables.sql";


########################################################Counter for measurement mobmgmnt mobmgmlr mobmgmra###################################
my @lb9 =  (
"405.4.2.3",
"405.4.2.2",
"405.4.2.1",
"402.3.1.4",
"402.3.2.3",
"402.3.2.4",
"402.3.2.1",
"402.3.2.2",
"402.3.1.1",
"402.3.1.3",
"402.3.1.2",
"413.2.3",
"413.2.2",
"413.2.1",
"1.2.10",
"1.2.9",
"1.0.3",
"1.0.2",
"1.0.1",
"1.2.1",
"1.2.3",
"1.2.2",
"1.2.4",
"1.2.0",
"1.2.5",
"1.2.7",
"1.2.6",
"1.2.8",
"1.0.8",
"1.0.7",
"1.0.6",
"1.0.5",
"1.0.4",
"1.1.0",
"1.1.2",
"1.1.1",
"1.1.3",
"1.1.4",
"1.1.5",
"4.0.2",
"4.0.3",
"4.0.0",
"4.1.0",
"4.1.3",
"4.1.2",
"4.2.3",
"4.2.0",
"4.2.1",
"4.2.2",
"9.1.0",
"9.1.1",
"9.0.0",
"9.0.1",
"1.0.8",
"1.0.1",
"1.2.2",
"1.2.1",
"1.0.3",
"1.2.0",
"1.0.2",
"1.2.10",
"1.0.5",
"1.2.9",
"1.0.4",
"1.2.8",
"1.0.7",
"1.2.7",
"1.0.6",
"1.2.6",
"1.2.3",
"1.2.4",
"1.2.5",
"1.1.5",
"1.1.4",
"1.1.0",
"1.1.1",
"1.1.2",
"1.1.3",
"4.0.0",
"4.1.3",
"4.0.3",
"4.0.2",
"4.2.2",
"4.2.3",
"4.2.0",
"4.2.1",
"4.1.2",
"4.1.0",
"9.0.0",
"9.0.1",
"9.1.0",
"9.1.1",
"1.0.8",
"1.0.7",
"1.0.6",
"1.2.10",
"1.2.9",
"1.2.3",
"1.0.5",
"1.2.4",
"1.2.1",
"1.2.2",
"1.2.0",
"1.2.7",
"1.2.8",
"1.2.5",
"1.2.6",
"1.0.3",
"1.0.4",
"1.0.1",
"1.0.2",
"1.1.1",
"1.1.2",
"1.1.3",
"1.1.4",
"1.1.5",
"1.1.0",
"4.0.0",
"4.0.2",
"4.0.3",
"4.2.2",
"4.2.1",
"4.2.3",
"4.2.0",
"4.1.0",
"4.1.2",
"4.1.3",
"9.1.1",
"9.0.1",
"9.0.0",
"9.1.0",
"1.2.5",
"1.2.9",
"1.2.4",
"1.2.8",
"1.2.3",
"1.2.2",
"1.2.1",
"1.2.0",
"1.0.1",
"1.0.3",
"1.0.2",
"1.0.6",
"1.0.7",
"1.0.4",
"1.2.10",
"1.0.5",
"1.0.8",
"1.2.6",
"1.2.7",
"1.1.5",
"1.1.4",
"1.1.3",
"1.1.2",
"1.1.0",
"1.1.1",
"4.0.0",
"4.0.2",
"4.0.3",
"4.2.3",
"4.2.2",
"4.2.1",
"4.2.0",
"4.1.3",
"4.1.2",
"4.1.0",
"9.0.1",
"9.0.0",
"9.1.1",
"9.1.0",
"20.1.1",
"288.0.0",
"288.1.2",
"288.0.5",
"288.1.0",
"288.1.1",
"288.0.2",
"288.0.1",
"288.0.4",
"288.0.3",
"289.0.7",
"289.0.6",
"286.0.29",
"286.0.27",
"286.0.28",
"286.2.9",
"286.0.7",
"286.0.8",
"286.0.9",
"286.0.3",
"286.0.4",
"286.0.5",
"286.0.6",
"286.0.0",
"286.0.1",
"286.0.2",
"286.0.34",
"286.0.33",
"286.0.32",
"286.0.31",
"286.0.30",
"286.0.16",
"286.0.17",
"286.0.18",
"286.0.19",
"286.0.24",
"286.0.23",
"286.0.26",
"286.0.25",
"286.0.20",
"286.0.22",
"286.0.21",
"286.0.11",
"286.0.10",
"286.0.15",
"286.0.14",
"286.0.13",
"286.0.12",
"286.1.1",
"286.1.0",
"286.1.9",
"286.1.8",
"286.1.7",
"286.1.6",
"286.1.5",
"286.1.4",
"286.1.3",
"286.1.2",
"286.2.4",
"286.2.3",
"286.2.2",
"286.2.1",
"286.2.8",
"286.2.7",
"286.3.0",
"286.2.6",
"286.3.1",
"286.2.5",
"286.2.0",
"287.0.7",
"287.0.6",
"287.0.3",
"287.0.2",
"287.0.5",
"287.0.4",
"287.0.1",
"287.0.0",
"294.5.1",
"294.0.1",
"294.0.2",
"294.3.1",
"294.0.3",
"294.3.2",
"294.0.4",
"294.0.5",
"294.3.0",
"294.3.5",
"294.0.6",
"294.3.3",
"294.3.4",
"294.5.0",
"294.4.1",
"294.4.0",
"294.4.3",
"294.4.2",
"293.1.1",
"293.1.0",
"293.0.10",
"293.0.8",
"293.0.7",
"293.0.9",
"293.0.0",
"293.0.2",
"293.0.1",
"293.0.4",
"293.0.3",
"293.0.6",
"293.0.5",
"280.3.3",
"280.3.2",
"280.3.1",
"280.3.0",
"280.4.0",
"280.4.2",
"280.4.1",
"280.2.0",
"280.2.2",
"280.2.1",
"280.0.1",
"280.1.1",
"280.1.0",
"280.1.3",
"280.1.2",
"280.6.1",
"280.6.2",
"280.5.4",
"280.5.5",
"280.6.0",
"280.5.2",
"280.6.5",
"280.5.3",
"280.5.0",
"280.6.3",
"280.5.1",
"280.6.4",
"285.0.4",
"285.0.5",
"285.0.6",
"285.0.7",
"285.0.8",
"285.0.9",
"285.0.0",
"285.0.1",
"285.0.2",
"285.0.3",
"285.2.10",
"285.2.11",
"285.2.12",
"285.2.13",
"285.2.8",
"285.2.9",
"285.2.6",
"285.2.7",
"285.2.4",
"285.1.1",
"285.2.5",
"285.1.2",
"285.2.2",
"285.2.3",
"285.1.0",
"285.2.0",
"285.1.5",
"285.2.1",
"285.1.6",
"285.1.3",
"285.1.4",
"285.1.9",
"285.1.7",
"285.1.8",
"292.1.2",
"292.1.1",
"292.1.0",
"292.0.10",
"292.0.11",
"292.0.8",
"292.0.9",
"292.0.6",
"292.0.7",
"292.0.4",
"292.0.5",
"292.0.2",
"292.0.3",
"292.0.0",
"292.0.1",
"291.0.5",
"291.0.6",
"291.0.1",
"291.0.2",
"291.0.3",
"291.0.4",
"291.0.0",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.1",
"8.1.1",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.1",
"8.1.1",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.1",
"8.1.1",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.1",
"8.1.1",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.1",
"8.0.0",
"294.1.3",
"294.1.2",
"294.1.1",
"280.8.2",
"280.8.1",
"280.8.0",
"280.7.1",
"280.9.2",
"280.9.1",
"280.7.0",
"280.9.3",
"280.0.0",
"405.1.1.1",
"405.1.1.3",
"405.4.1.1",
"405.4.1.2",
"405.4.1.3",
"405.4.2.1",
"405.4.2.2",
"405.4.2.3",
"289.0.7",
"289.1.0",
"289.1.1",
"285.2.0",
"285.2.1",
"285.2.2",
"285.2.3",
"285.2.4",
"306.1.1",
"306.1.2",
"306.1.3",
"306.2.1",
"306.2.2",
"306.2.3",
"306.2.4",
"306.2.5",
"306.2.6",
"306.2.7",
"306.2.8",
"306.2.9",
"306.3.0",
"306.3.1",
"306.3.2",
"306.3.3",
"306.3.4",
"306.3.5",
"306.3.6",
"306.3.7",
"306.3.8",
"306.3.9",
"306.4.0",
"306.4.1",
"306.4.2",
"306.4.3",
"306.4.4",
"306.4.5",
"306.4.6",


) ;

my @lb10 =  (
"402.3.1.4",
"402.3.1.3",
"402.3.1.2",
"402.3.1.1",
"402.3.2.1",
"402.3.2.3",
"402.3.2.2",
"402.3.2.4",
"413.1.1",
"413.1.2",
"413.2.1",
"413.2.2",
"1.2.6",
"1.2.5",
"1.2.8",
"1.2.7",
"1.2.9",
"1.2.10",
"1.2.0",
"1.2.1",
"1.2.2",
"1.0.8",
"1.2.3",
"1.0.7",
"1.2.4",
"1.0.6",
"1.0.5",
"1.0.4",
"1.0.3",
"1.0.2",
"1.0.1",
"1.1.1",
"1.1.2",
"1.1.0",
"1.1.5",
"1.1.3",
"1.1.4",
"4.0.3",
"4.0.2",
"4.2.2",
"4.0.0",
"4.2.1",
"4.2.0",
"4.1.0",
"4.1.2",
"4.1.3",
"4.2.3",
"9.1.0",
"9.0.0",
"9.1.1",
"9.0.1",
"1.2.0",
"1.2.1",
"1.2.2",
"1.2.3",
"1.2.8",
"1.2.7",
"1.0.8",
"1.2.9",
"1.0.6",
"1.2.4",
"1.0.7",
"1.0.4",
"1.2.6",
"1.0.5",
"1.2.5",
"1.0.2",
"1.1.5",
"1.0.3",
"1.1.4",
"1.2.10",
"1.0.1",
"1.1.1",
"1.1.0",
"1.1.3",
"1.1.2",
"4.1.3",
"4.0.2",
"4.1.2",
"4.0.3",
"4.1.0",
"4.0.0",
"4.2.1",
"4.2.0",
"4.2.3",
"4.2.2",
"9.0.1",
"9.0.0",
"9.1.0",
"9.1.1",
"1.2.10",
"1.0.7",
"1.0.6",
"1.0.8",
"1.0.3",
"1.0.2",
"1.0.5",
"1.0.4",
"1.2.7",
"1.2.6",
"1.2.9",
"1.2.8",
"1.2.3",
"1.2.1",
"1.2.2",
"1.2.5",
"1.2.4",
"1.2.0",
"1.0.1",
"1.1.3",
"1.1.4",
"1.1.5",
"1.1.2",
"1.1.1",
"1.1.0",
"4.0.0",
"4.0.2",
"4.0.3",
"4.1.0",
"4.1.2",
"4.1.3",
"4.2.2",
"4.2.1",
"4.2.0",
"4.2.3",
"9.1.1",
"9.1.0",
"9.0.0",
"9.0.1",
"1.2.5",
"1.2.6",
"1.2.3",
"1.2.4",
"1.2.9",
"1.2.10",
"1.2.7",
"1.2.8",
"1.1.4",
"1.2.0",
"1.1.5",
"1.2.2",
"1.2.1",
"1.1.3",
"1.1.2",
"1.1.1",
"1.1.0",
"1.0.7",
"1.0.8",
"1.0.1",
"1.0.2",
"1.0.5",
"1.0.6",
"1.0.3",
"1.0.4",
"4.2.1",
"4.2.0",
"4.2.3",
"4.2.2",
"4.0.2",
"4.0.3",
"4.0.0",
"4.1.0",
"4.1.2",
"4.1.3",
"9.1.0",
"9.1.1",
"9.0.0",
"9.0.1",
"288.1.0",
"288.1.1",
"288.1.2",
"288.0.1",
"288.0.0",
"288.0.3",
"288.0.2",
"288.0.5",
"288.0.4",
"286.0.26",
"286.0.27",
"286.0.28",
"286.0.29",
"286.0.22",
"286.0.23",
"286.0.24",
"286.0.25",
"286.0.21",
"286.0.20",
"286.1.6",
"286.2.9",
"286.0.17",
"286.1.5",
"286.2.8",
"286.0.18",
"286.1.4",
"286.2.7",
"286.0.15",
"286.1.3",
"286.2.6",
"286.0.16",
"286.1.2",
"286.0.13",
"286.1.1",
"286.0.14",
"286.1.0",
"286.0.11",
"286.0.12",
"286.2.1",
"286.2.0",
"286.2.5",
"286.2.4",
"286.1.9",
"286.1.8",
"286.2.3",
"286.0.19",
"286.1.7",
"286.2.2",
"286.0.10",
"286.3.1",
"286.3.0",
"286.0.3",
"286.0.2",
"286.0.1",
"286.0.0",
"286.0.7",
"286.0.6",
"286.0.5",
"286.0.4",
"286.0.9",
"286.0.8",
"286.0.34",
"286.0.33",
"286.0.31",
"286.0.32",
"286.0.30",
"287.0.7",
"287.0.2",
"287.0.1",
"287.0.0",
"287.0.6",
"287.0.5",
"287.0.4",
"287.0.3",
"306.3.1",
"306.3.0",
"306.3.3",
"306.3.2",
"306.1.2",
"306.1.3",
"306.2.2",
"306.1.1",
"306.2.1",
"306.2.4",
"306.2.3",
"306.2.5",
"306.2.6",
"306.2.7",
"306.2.8",
"306.2.9",
"306.3.8",
"306.3.9",
"306.3.4",
"306.3.5",
"306.3.6",
"306.3.7",
"306.5.2",
"306.5.3",
"306.4.5",
"306.4.6",
"306.4.3",
"306.4.4",
"306.4.2",
"306.4.1",
"306.4.0",
"306.5.1",
"306.5.0",
"294.0.4",
"294.5.1",
"294.0.3",
"294.5.0",
"294.0.6",
"294.0.5",
"294.0.1",
"294.0.2",
"294.3.4",
"294.3.5",
"294.3.2",
"294.3.3",
"294.3.0",
"294.3.1",
"294.4.1",
"294.4.2",
"294.4.0",
"294.4.3",
"293.0.0",
"293.0.1",
"293.0.2",
"293.0.3",
"293.1.1",
"293.1.0",
"293.0.10",
"293.0.9",
"293.0.8",
"293.0.7",
"293.0.6",
"293.0.5",
"293.0.4",
"280.4.2",
"280.3.3",
"280.0.1",
"280.5.0",
"280.5.3",
"280.5.4",
"280.5.1",
"280.5.2",
"280.4.0",
"280.4.1",
"280.5.5",
"280.1.1",
"280.1.2",
"280.1.3",
"280.6.4",
"280.6.5",
"280.2.1",
"280.6.2",
"280.2.0",
"280.6.3",
"280.6.0",
"280.1.0",
"280.2.2",
"280.6.1",
"280.3.0",
"280.9.2",
"280.9.1",
"280.3.2",
"280.3.1",
"280.8.2",
"280.9.3",
"280.8.1",
"280.8.0",
"280.7.1",
"280.7.0",
"295.1.0",
"295.1.9",
"295.2.2",
"295.2.0",
"295.2.1",
"295.1.3",
"295.1.4",
"295.1.1",
"295.1.2",
"295.1.7",
"295.1.8",
"295.1.5",
"295.1.6",
"285.2.10",
"285.2.11",
"285.2.13",
"285.2.12",
"285.0.0",
"285.0.9",
"285.0.6",
"285.0.5",
"285.0.8",
"285.0.7",
"285.0.2",
"285.1.14",
"285.0.1",
"285.1.13",
"285.0.4",
"285.1.12",
"285.0.3",
"285.1.11",
"285.2.3",
"285.1.8",
"285.2.4",
"285.1.10",
"285.1.9",
"285.2.5",
"285.2.6",
"285.2.0",
"285.2.1",
"285.2.2",
"285.1.0",
"285.1.1",
"285.1.2",
"285.1.3",
"285.2.7",
"285.1.4",
"285.2.8",
"285.1.5",
"285.2.9",
"285.1.6",
"285.1.7",
"292.0.0",
"292.0.4",
"292.0.3",
"292.0.2",
"292.0.1",
"292.0.5",
"292.0.6",
"292.0.10",
"292.0.7",
"292.0.11",
"292.0.8",
"292.0.9",
"292.1.2",
"292.1.0",
"292.1.1",
"291.0.4",
"291.0.5",
"291.0.2",
"291.0.3",
"291.0.0",
"291.0.1",
"291.0.6",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"8.0.0",
"8.1.1",
"8.1.0",
"8.1.1",
"8.0.0",
"8.0.1",
"8.1.1",
"8.1.0",
"8.0.0",
"8.0.1",
"20.1.1",

) ;





print "===============================================================\n";
print "Start Spliting \n";
print "===============================================================\n";

######################################################################################
#################Modify sgscdb_cre_rawviews.sql#######################




my @diff9to10 = qw {

} ;

my @diff10to9 = qw {

} ;

my @final9to10 = qw {

} ;

my @final10to9 = qw {

} ;


################Compare between different between 9 and 10, then store the difference###############

for ( my $i = 0; $i < scalar( @lb9 ); $i++ )
{
open INPUT, "array10.txt" or die "ERROR: cant open file lb10.txt\n";
my @data = ();
my $p = 0;
while(<INPUT>){

       if(m/$lb9[$i]/i)
	   {
	   $p =1
	   }

}
 if ($p != 1)
 {
 push(@diff9to10,"$lb9[$i]");
 }

}
close INPUT;

print "The missing counter in ne is:" ;
print ("@diff9to10\n");

open F, ">9to10.txt" or die "$! Can't create file";
print F $_.$/ foreach @diff9to10;
close F;

#########Find the diff counter full name and store them#########


for ( my $i = 0; $i < scalar( @diff9to10 ); $i++ )
{
open INPUT, "rlb9.txt" or die "ERROR: cant open file lb9.txt\n";
my @data = ();
my $p = 0;
while(<INPUT>){

       if(m/$diff9to10[$i]/i)
	   {
		push(@final9to10,"$_");
		}
 }

}
close INPUT;


open F, ">final9to10.txt" or die "$! Can't create file";
print F $_.$/ foreach @final9to10;
close F;



################Compare between different 10 and 9 then store the difference###############



for ( my $i = 0; $i < scalar( @lb10 ); $i++ )
{
open INPUT, "array9.txt" or die "ERROR: cant open file lb9.txt\n";
my @data = ();
my $p = 0;
while(<INPUT>){

       if(m/$lb10[$i]/i)
	   {
	   $p =1
	   }

}
 if ($p != 1)
 {
 push(@diff10to9,"$lb10[$i]");
 }

}
close INPUT;

print "The missing counter in ad is:" ;
print ("@diff10to9\n");

open F, ">10to9.txt" or die "$! Can't create file";
print F $_.$/ foreach @diff10to9;
close F;


#########Find the diff counter full name and store them#########


for ( my $i = 0; $i < scalar( @diff10to9 ); $i++ )
{
open INPUT, "rlb10.txt" or die "ERROR: cant open file lb9.txt\n";
my @data = ();
my $p = 0;
while(<INPUT>){

       if(m/$diff10to9[$i]/i)
	   {
		push(@final10to9,"$_");
		}
 }

}
close INPUT;


open F, ">final10to9.txt" or die "$! Can't create file";
print F $_.$/ foreach @final10to9;
close F;






